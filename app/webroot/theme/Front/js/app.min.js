/* App -- dev */function bootstrapAngular() {
    console.log("Bootstrapping AngularJS");
    var domElement = document.querySelector("body");
    angular.bootstrap(domElement, [ "app" ]);
}

angular.module("cake", [ "ngResource" ]).controller("cakeCtrl", [ "$scope", "data", function($scope, data) {
    $scope.data = data;
} ]).value("server", {
    url: "http://localhost:8888/github/awallef/climatec-sa.com/"
}).factory("cakePHP", [ "$resource", "server", function($resource, server) {
    return $resource(server.url + "json/:custom1/:custom2/:controller/:action/:sort/:direction/:page/:id/:param.json", {
        custom1: "@custom1",
        custom2: "@custom2",
        controller: "@controller",
        action: "@action",
        sort: "@sort",
        direction: "@direction",
        page: "@page",
        id: "@id",
        param: "@param"
    }, {
        queryjsonp: {
            method: "JSONP",
            params: {
                callback: "JSON_CALLBACK"
            },
            callback: "JSON_CALLBACK"
        },
        queryput: {
            method: "PUT"
        },
        querypost: {
            method: "POST"
        },
        querydelete: {
            method: "DELETE"
        }
    });
} ]), angular.module("appDep", []), angular.module("appDep").controller("activityBytypeCtrl", [ "$scope", "data", "title", function($scope, data, title) {
    $scope.data = data, $scope.title = title;
} ]), angular.module("appDep").controller("customersIndexCtrl", [ "$scope", "$window", "$filter", "data", function($scope, $window, $filter, data) {
    $scope.data = data, $scope.customerListClick = function(id) {
        var anchor = $filter("slug")(id), elem = $window.document.getElementById(anchor), bounding = elem.getBoundingClientRect(), y = $window.innerWidth < 678 ? bounding.top - 61 : bounding.top - 114;
        y -= 10, $window.scrollTo(0, y);
    };
} ]), angular.module("appDep").controller("CarouselCtrl", function($scope) {
    $scope.myInterval = 5e3;
    $scope.slides = [ {
        image: "img/static/banner_3.jpeg",
        text: "Climatisation & Ventilation"
    }, {
        image: "img/static/banner_4.jpeg",
        text: "Climatisation & Ventilation"
    } ];
}), angular.module("appDep").controller("elementsHeaderCtrl", [ "$scope", "$window", function($scope, $window) {
    $scope.navCollapsed = !0, $scope.navClick = function() {
        $window.innerWidth < 678 && ($scope.navCollapsed = !0);
    };
} ]), angular.module("appDep").controller("homeCtrl", [ "$scope", "partners", "works", function($scope, partners, works) {
    $scope.data = {
        partners: partners.partners,
        works: works.works
    };
} ]), angular.module("appDep").controller("contactCtrl", [ "$scope", "cakePHP", "growl", function($scope, cakePHP, growl) {
    $scope.message = {
        name: "Votre Nom Complet",
        email: "votre@email.com",
        message: ""
    }, $scope.sendMessage = function() {
        cakePHP.querypost({
            controller: "main",
            action: "email"
        }, {
            message: $scope.message
        }).$promise.then(function(value) {
            value.success ? growl.success("Votre message a bien été envoyé!") : growl.error("Une erreure est survenue, veuillez essayer à nouveau!");
        }, function() {
            growl.error("Le serveur n'a pas répondu, veuillez essayer à nouveau!");
        });
    };
} ]), angular.module("appDep").controller("entrepriseCtrl", [ "$scope", function() {} ]), 
angular.module("appDep").controller("partnersCtrl", [ "$scope", "partners", "works", function($scope, partners, works) {
    $scope.data = {
        partners: partners.partners,
        works: works.works
    };
} ]), angular.module("appDep").controller("worksIndexCtrl", [ "$scope", "customers", "works", "activities", "activityTypes", function($scope, customers, works, activities, activityTypes) {
    $scope.data = {}, $scope.data.customers = customers.customers, $scope.data.works = works.works, 
    $scope.data.activities = activities.activities, $scope.data.activityTypes = activityTypes.activityTypes, 
    $scope.myFilter = {
        activityTypes: "id-0-id",
        activities: "id-0-id",
        customers: "id-0-id"
    };
    var customers = {};
    for (var i in $scope.data.works) {
        var activity, work = $scope.data.works[i];
        work.customers = work.activityTypes = work.activities = [ "id-0-id" ];
        for (var customer in work.Customer) {
            var customerId = work.Customer[customer].id;
            work.customers.push("id-" + customerId + "-id"), customers.hasOwnProperty(customerId) || (customers[customerId] = {
                activities: [],
                activityTypes: []
            });
            for (activity in work.Activity) customers[customerId].activities.push("id-" + work.Activity[activity].id + "-id"), 
            customers[customerId].activityTypes.push("id-" + work.Activity[activity].activity_type_id + "-id");
        }
        for (activity in work.Activity) work.activities.push("id-" + work.Activity[activity].id + "-id"), 
        work.activityTypes.push("id-" + work.Activity[activity].activity_type_id + "-id");
        $scope.data.works[i] = work;
    }
    for (i in $scope.data.activityTypes) {
        var activityType = $scope.data.activityTypes[i];
        activityType.listId = "id-" + activityType.ActivityType.id + "-id", $scope.data.activityTypes[i] = activityType;
    }
    $scope.data.activityTypes.unshift({
        listId: "id-0-id",
        ActivityType: {
            name: "Toutes"
        }
    });
    for (i in $scope.data.activities) activity = $scope.data.activities[i], activity.listId = "id-" + activity.Activity.id + "-id", 
    activity.activityTypes = [], activity.activityTypes.push("id-" + activity.Activity.activity_type_id + "-id"), 
    $scope.data.activities[i] = activity;
    for (var i in $scope.data.customers) {
        var customer = $scope.data.customers[i];
        customerId = customer.Customer.id, customer.listId = "id-" + customerId + "-id", 
        customer.activities = [], customer.activityTypes = [];
        for (var key in customers[customerId].activities) {
            var activityId = customers[customerId].activities[key], activityTypeId = customers[customerId].activityTypes[key];
            -1 == customer.activities.indexOf(activityId) && (customer.activities.push(activityId), 
            customer.activityTypes.push(activityTypeId));
        }
        $scope.data.customers[i] = customer;
    }
} ]), angular.module("appDep").controller("worksViewCtrl", [ "$scope", "work", "works", function($scope, work, works) {
    $scope.data = {}, $scope.data.work = work.work, $scope.data.works = works.works;
} ]), angular.module("appDep").directive("imgResize", function() {
    function link(scope, element, attrs) {
        attrs.$set("src", attrs.imgResize);
    }
    return {
        restrict: "A",
        scope: {},
        link: link
    };
}), angular.module("appDep").filter("date", function() {
    return function(dateString) {
        var dateObject = new Date(dateString);
        return dateObject.getDay() + "." + dateObject.getMonth() + "." + dateObject.getFullYear();
    };
}), angular.module("appDep").filter("nl2br", function($sce) {
    return function(msg, is_xhtml) {
        var is_xhtml = is_xhtml || !0, breakTag = is_xhtml ? "<br />" : "<br>", msg = (msg + "").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g, "$1" + breakTag + "$2");
        return $sce.trustAsHtml(msg);
    };
}), angular.module("appDep").filter("slug", function() {
    return function(input) {
        return input ? input.toLowerCase().replace(/[^a-z\-]/g, "-").replace(" ", "-") : void 0;
    };
}), angular.module("app", [ "ui.router", "ui.bootstrap", "ngResource", "angular-images-loaded", "angular-growl", "cake", "appDep" ]).value("server", {
    url: ""
}).controller("mainCtrl", [ "$scope", function($scope) {
    $scope.loading = !1, $scope.error = !1, $scope.$on("$stateChangeStart", function(event, toState) {
        toState.resolve && ($scope.loading = !0, $scope.error = !1);
    }), $scope.$on("$stateChangeSuccess", function(event, toState) {
        toState.resolve;
    }), $scope.$on("$stateNotFound", function(event, toState) {
        toState.resolve && ($scope.loading = !1, $scope.error = !0);
    }), $scope.$on("$stateChangeError", function(event, toState) {
        toState.resolve && ($scope.loading = !1, $scope.error = !0);
    }), $scope.imgLoadedEvents = {
        always: function() {
            $scope.loading = !1;
        },
        done: function() {
            $scope.error = !1;
        },
        fail: function() {
            $scope.error = !1;
        }
    };
} ]).run([ "$rootScope", "$state", "$stateParams", function($rootScope, $state, $stateParams) {
    $rootScope.$state = $state, $rootScope.$stateParams = $stateParams;
} ]).config([ "$locationProvider", "$stateProvider", "$urlRouterProvider", function($locationProvider, $stateProvider) {
    $locationProvider.html5Mode(!0), $locationProvider.hashPrefix("!"), $stateProvider.state("home", {
        url: "/app/accueil",
        templateUrl: "theme/Front/partials/home/index.html",
        data: {
            pageTitle: "Climatec : Accueil"
        },
        resolve: {
            cakePHP: "cakePHP",
            partners: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "partners",
                    action: "index"
                }).$promise;
            },
            works: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "works",
                    action: "lasts",
                    param: "4"
                }).$promise;
            }
        },
        controller: "homeCtrl",
        controllerAs: "controller"
    }).state("partenaires", {
        url: "/app/partenaires",
        templateUrl: "theme/Front/partials/partners/index.html",
        data: {
            pageTitle: "Climatec : Nos partenaires"
        },
        resolve: {
            cakePHP: "cakePHP",
            partners: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "partners",
                    action: "index"
                }).$promise;
            },
            works: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "works",
                    action: "lasts",
                    param: "4"
                }).$promise;
            }
        },
        controller: "partnersCtrl",
        controllerAs: "controller"
    }).state("contact", {
        url: "/app/contact",
        templateUrl: "theme/Front/partials/pages/contact.html",
        data: {
            pageTitle: "Climatec : Contact"
        },
        controller: "contactCtrl",
        controllerAs: "controller"
    }).state("entreprise", {
        url: "/app/entreprise",
        templateUrl: "theme/Front/partials/pages/entreprise.html",
        data: {
            pageTitle: "Climatec : Notre Entreprise"
        },
        controller: "entrepriseCtrl",
        controllerAs: "controller"
    }).state("works-index", {
        url: "/app/realisations",
        templateUrl: "theme/Front/partials/works/index.html",
        data: {
            pageTitle: "Climatec : La lsite de nos réalisations"
        },
        resolve: {
            cakePHP: "cakePHP",
            customers: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "customers",
                    action: "index"
                }).$promise;
            },
            activities: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "activities",
                    action: "index"
                }).$promise;
            },
            activityTypes: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "activity_types",
                    action: "index"
                }).$promise;
            },
            works: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "works",
                    action: "index"
                }).$promise;
            }
        },
        controller: "worksIndexCtrl",
        controllerAs: "controller"
    }).state("activities-bytype-climatisation", {
        url: "/app/climatisation",
        templateUrl: "theme/Front/partials/activities/bytype.html",
        data: {
            pageTitle: "Climatec : Domaines d activité"
        },
        resolve: {
            title: function() {
                return "Climatisation";
            },
            cakePHP: "cakePHP",
            data: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "activities",
                    action: "bytype",
                    id: 1
                }).$promise;
            }
        },
        controller: "activityBytypeCtrl",
        controllerAs: "controller"
    }).state("activities-bytype-ventilation", {
        url: "/app/ventilation",
        templateUrl: "theme/Front/partials/activities/bytype.html",
        data: {
            pageTitle: "Climatec : Domaines d activité"
        },
        resolve: {
            title: function() {
                return "Ventilation";
            },
            cakePHP: "cakePHP",
            data: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "activities",
                    action: "bytype",
                    id: 2
                }).$promise;
            }
        },
        controller: "activityBytypeCtrl",
        controllerAs: "controller"
    }).state("works-view", {
        url: "/app/realisation/:workId/:workTitle",
        templateUrl: "theme/Front/partials/works/view.html",
        data: {
            pageTitle: "Climatec : En détail"
        },
        resolve: {
            cakePHP: "cakePHP",
            work: function(cakePHP, $stateParams) {
                var workId = $stateParams.workId;
                return cakePHP.queryjsonp({
                    controller: "works",
                    action: "view",
                    id: workId
                }).$promise;
            },
            works: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "works",
                    action: "lasts",
                    param: "4"
                }).$promise;
            }
        },
        controller: "worksViewCtrl",
        controllerAs: "controller"
    }).state("clients-index", {
        url: "/app/clients",
        templateUrl: "theme/Front/partials/customers/index.html",
        data: {
            pageTitle: "Climatec : Nos clients"
        },
        resolve: {
            cakePHP: "cakePHP",
            data: function(cakePHP) {
                return cakePHP.queryjsonp({
                    controller: "customers",
                    action: "index"
                }).$promise;
            }
        },
        controller: "customersIndexCtrl",
        controllerAs: "controller"
    });
} ]), -1 === document.URL.indexOf("http://") && -1 === document.URL.indexOf("https://") ? (console.log("URL: Running in Cordova/PhoneGap"), 
document.addEventListener("deviceready", bootstrapAngular, !1)) : (console.log("URL: Running in browser"), 
bootstrapAngular());